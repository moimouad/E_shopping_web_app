<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
  xmlns:p="http://primefaces.org/ui">

<h:head>

   <f:metadata>
  	<f:event listener="#{accountView.verifyLoginOnWelcomedummy()}" type="preRenderView"></f:event>
  	<f:event listener="#{accountView.checkloginstatus()}" type="preRenderView"></f:event>

  </f:metadata>

	<link rel="stylesheet" type="text/css" href="resources/css/items.css"/>
	<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css"/>
	<link href="https://fonts.googleapis.com/css?family=Cinzel" rel="stylesheet"/>
	<link href="https://fonts.googleapis.com/css?family=Days+One" rel="stylesheet"/>
	
	 <title> Products </title>
</h:head>

<h:body>

<ul class="topnav">

  <li><h:form><h:commandLink value="Home" action = "items.xhtml" ></h:commandLink></h:form></li> 
  <li><h:form><h:commandLink value="All Products" action = "#{productView.chose(0)}" styleClass="active"><f:setPropertyActionListener value="#{null}" target="#{productView.chose}"/></h:commandLink></h:form></li>   
  <c:forEach var="category" items="#{categoriesView.categories}">
  	<li>
  		<h:form>
  			<h:commandLink value="#{category.name}" action = "#{productView.chose()}">
  				<f:setPropertyActionListener value="#{category.name}" target="#{productView.chose}"/>
  			</h:commandLink>
  		</h:form>
  	</li>
  </c:forEach>
  
  <li class="right" style="#{accountView.loggedin ? '' : 'display:none'}"><h:form><h:commandLink action="orders?faces-redirect=true" value = "orders" onclick="#"/></h:form></li>
  <li class="right" id="username" style="#{accountView.loggedin ? '' : 'display:none'}"><h:form><h:commandLink action="profile.xhtml" value = "#{accountView.username}"/></h:form></li>
  <li class="right" style="#{accountView.loggedin ? '' : 'display:none'}"><h:form><h:commandLink action="#{accountView.logout()}" value = "Logout" /></h:form></li>
  <li class="right" style="#{accountView.loggedin ? 'display:none' : ''}"><h:form><h:commandLink action="index.xhtml" value = "Login/Signup"/></h:form></li>
  <li class="right" style="#{accountView.admin() ? '' : 'display:none'}"><h:form><h:commandLink action="admin_categ.xhtml" value = "Admin Espace"/></h:form></li>
  <li class = "right" style="#{accountView.loggedin ? '' : 'display:none'}"><h:form><h:commandLink action="#" onclick="#"><span class="fontawesome-shopping-cart"></span><h:outputText value = "not yet"></h:outputText></h:commandLink></h:form></li>
  
</ul>

<!-- Debut Body !!! -->

<h:form id="form">
    <p:dataGrid var="product" value="#{productView.products}" columns="3" layout="grid"
        rows="12" paginator="true" id="products"
        paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
        rowsPerPageTemplate="6,12,16"  >
         
        <f:facet name="header">
            Products
        </f:facet>
 
        <p:panel header="#{product.id}" style="text-align:center">
            <h:panelGrid columns="1" style="width:100%">
               <p:graphicImage url="#{product.imageUrl}" style = "width:150px;height:150px" />
 
               <h:outputText value="#{product.name}" />
                
                <!--  
                <p:commandButton  value="View Detail" onclick="PF('deleteitemDialog').show()" >
			        <f:setPropertyActionListener value="#{product}" target="#{productView.selected}" />
		    	</p:commandButton>
		    	-->
		    	
			<p:commandButton  update=":test:carDetail" value="View Detail" oncomplete="PF('carDialog').show()">
				<f:setPropertyActionListener value="#{product}" target="#{productView.selected}"/>
		       <!--   <f:setPropertyActionListener value="#{product.id}" target="#{productView.id}" />
		        <f:setPropertyActionListener value="#{product.name}" target="#{productView.name}" />
		        <f:setPropertyActionListener value="#{product.description}" target="#{productView.description}" />
		        <f:setPropertyActionListener value="#{product.price}" target="#{productView.price}" />
		        <f:setPropertyActionListener value="#{product.imageUrl}" target="#{productView.imageUrl}" />-->
	    	</p:commandButton >

            </h:panelGrid>
        </p:panel>
 
    </p:dataGrid>
</h:form>
 
<h:form id="test">
	<p:dialog header="Produit" widgetVar="carDialog" resizable="false">
		<p:outputPanel id="carDetail" style="text-align:center;">
        	<p:panelGrid  columns="2" rendered="#{not empty productView.selected}" columnClasses="label,value">
            
                <f:facet name="header">
                    <p:graphicImage url="#{productView.selected.imageUrl}"   style = "width:300px;height:300px"/> 
                </f:facet>
                 
                <h:outputText value="Id :" />
                <h:outputText value="#{productView.selected.id}" />
 
                <h:outputText value="Name : " />
                <h:outputText value="#{productView.selected.name}" />
 
                <h:outputText value="Description :" />
                <h:outputText value="#{productView.selected.description}"/>
             
                <h:outputText value="Price" />
                <h:outputText value="#{productView.selected.price} DH" />
                
                <h:outputText value="Disponible : " />
                <h:outputText value="#{productView.selected.quantity}" />
                
                <h:outputText value="Category : " />
                <h:outputText value="#{productView.selected.category}" />
            </p:panelGrid>
        </p:outputPanel>
	</p:dialog>
</h:form>

<!-- Fin Body !!! -->

</h:body>
</html>